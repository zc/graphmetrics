[buildout]
develop = .
parts = test paste extra-eggs buildout-script zookeeper-deploy
      ctl buildout_source_release
relative-paths = true
unzip = true
show-picked-versions = true
update-versions-file = versions.cfg
extends = versions.cfg

[buildout-script]
recipe = zc.recipe.egg:script
eggs = zc.buildout

[ctl]
recipe = zc.zdaemonrecipe
program = ${buildout:bin-directory}/paster serve ${paste.ini:location}

[test]
recipe = zc.recipe.testrunner
eggs = zc.graphmetrics [test]

[paste]
recipe = zc.recipe.egg
eggs = PasteScript
       zc.zodbwsgi
       zc.graphmetrics
       zc.wsgisessions
       zc.ngi
       bobo
interpreter = py

[database]
recipe = zc.recipe.filestorage

[paste.ini]
recipe = zc.recipe.deployment:configuration
text =
  [app:main]
  use = egg:bobo
  bobo_configure = zc.graphmetrics.tracelogs:config
                   zc.graphmetrics.auth:config
  bobo_resources = zc.graphmetrics.tracelogs
                   zc.graphmetrics.auth
  
  rrd = /home/jim/t/rrds
  # metrics-rrd = ${buildout:directory}/metrics
  
  filter-with = reload
  
  [filter:reload]
  use = egg:bobo#reload
  modules = zc.graphmetrics.tracelogs
            
  filter-with = browserid

  [filter:browserid]
  use = egg:zc.wsgisessions
            
  filter-with = zodb

  [filter:zodb]
  use = egg:zc.zodbwsgi
  filter-with = debug
  configuration =
    <zodb>
       <filestorage>
          path ${database:path}
       </filestorage>
    </zodb>
  
  initializer = zc.graphmetrics.auth:db_init
  
  [filter:debug]
  use = egg:bobo#debug
  
  [server:main]
  use = egg:Paste#http
  #host = log.att.zope.net
  port = 8080

[extra-eggs]
recipe = zc.recipe.egg:eggs
eggs =
  zdaemon
  zc.zdaemonrecipe
  zc.recipe.deployment
  zc.recipe.rhrc
  zc.recipe.filestorage
  z3c.recipe.mkdir

[rrdtool]
recipe = zc.recipe.cmmi
url = http://oss.oetiker.ch/rrdtool/pub/rrdtool.tar.gz

[py-rrdtool]
recipe = zc.recipe.egg:custom
egg = py-rrdtool
include-dirs = ${rrdtool:location}/include
rpath = ${rrdtool:location}/lib


[zookeeper-deploy]
recipe = zc.recipe.egg
eggs = zc.zookeeper_deploy_buildout
arguments = '', 'zc.graphmetrics'

[buildout_source_release]
recipe = zc.recipe.egg
eggs = zc.sourcerelease
